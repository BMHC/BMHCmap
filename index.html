<!DOCTYPE html>
<html lang="en" dir="ltr">
    
<!--
index1.html
Copyright 2021 John R C Fairfield, see MIT license

https://stackoverflow.com/questions/4130237/displaying-crosshairs-in-the-center-of-a-javascript-google-map

<div><a href="url to google drive of help documentation" target="_blank" float="right">help manual</a></div>

-->

<head>
<meta charset="utf8">
    
<style>
  
    body {
        font-size:medium;
        font-family: 'Times New Roman', serif;
        background-color:#faf0e6; /*linen is #faf0e6. Or rgb(230,255, 220) is a light green;*/
    }

    input{
        font-family:'Times New Roman', serif;
    }
    
    
    .container {
        padding:0px 20px 0px 20px;
    }

    .createButton {
        padding: 0px 0px;
        border: none;
        font-family: 'Times New Roman', serif;
        background-color:#fffaf0;
    }

    
    .title {
        box-sizing: border-box;
        padding: 16px 0px;
    }
    
    .assemblyWrite {
        box-sizing: border-box;
        padding:16px 50px;
    }

  
</style>

<link rel="stylesheet" href="listbox/css/listbox.css"> 
<script src="listbox/js/listbox.js" type="text/javascript"></script>
<script src="listbox/js/listbox-scrollable.js" type="text/javascript"></script>   
<script src="listbox/js/utils.js" type="text/javascript"></script>
<script src="BMHC.js"></script>
    
</head>
<body>
   <div class="container">
        <div class="title">
            Brethren Mennonite Heritage Center
            <h1>Map data editor</h1>
        </div>
       
        <div id="midscreen">

            <div id="mennoBroCheckboxen">
               <b>Assemblies</b>
                &nbsp;&nbsp;
                <input type="checkbox" id="bro" name="Brethren" onchange='handleChangeBrethren(this);'>
                <label for="bro">Brethren</label>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <input type="checkbox" id="mennonite" name="Mennonite" onchange='handleChangeMennonite(this);'>
                <label for="menno">Mennonite</label>
            </div>

            <div id="scanAssemblies">
                <br>
                <button class="createButton" >Click here to create a new assembly, </button>
                <br> or shift+click on a listed assembly to edit its name,
                <br> or click on a listed assembly to see its events.
                <br>
            </div> 

            <div id="editAssembly">         
                <form id="createAssembly" onsubmit="saveGroup()">
                    <br>
                    A unique assembly name: 
                    <br>
                    <input type="text" id="assemblyName" style="background-color:#d0efd0;" size=70 oninput="checkAssembly(this.value)">
                    <br>
                    <input type="submit" value = "cancel"> <input type="submit" value="SAVE">
                </form>
            </div>
            
            <div id="eventsConcerning">
               <b>Events concerning</b>&nbsp;<span id="anAssemblyName" style="font-weight:bold"></span>
            </div>
            
            <div id="scanEvents">
                <br>
                <button class="createButton" >Click here to create a new event, </button>
                <br> or shift+click on a listed event to edit its fields,
                <br> or click on a listed event to see the state of the assembly at that time.
                <br>
            </div> 
            
            <div class="editEvent">
                
                <form id="editEvent" onsubmit="saveGroup()">
                    <br>
                    <label for="eventDate">date (yyyy/mm/dd):</label>
                      <input type="text" id="eventDate" size=8 oninput="checkEventDate(this.value)">
                    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <label for="eventVerb">verb:</label>
                    <select name="eventVerb" id="eventVerb"  required="true">
                      <option value="set-weight">set-weight</option>
                      <option value="set-locale">set-locale</option>
                      <option value="set-affiliation">set-affiliation</option>
                      <option value="image">image</option>
                      <option value="see-note">see-note</option>
                    </select>
                    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <label>object:</label>
                    <input type="text" id="assemblyName" size=107 oninput="checkAssembly(this.value)">
                    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <label>note:</label>
                    <textarea type="text" id="eventNote" rows=3 cols=92 oninput="checkEventSubject(this.value)"> </textarea>
                    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <input type="submit" value = "cancel"> <input type="submit" value="SAVE">
                </form>
            </div>
            
            <div id="assemblyState">
                <br>
                date: 1925
                <br>
                locale: 38.377180983452404, -79.03095281203223 1915 note: College Ave church
                <br>
                weight: 521 1925
                <br>
                affiliation: 2nd District of Virginia 1907 note: "Bridgewater" becomes independent from "Cooks Creek".
            </div>
             
            
        </div> <!-- end of div id=aboveList -->
            <!--<div class="listbox-area" > -->

            <div class="all-area">
                <ul id="ss_elem_list"
                    tabindex="0"
                    role="listbox"
                    aria-labelledby="ss_elem"
                    style="background-color:#d0efd0;">
                </ul>
            </div>  
    </div>                                                         
<script>
    
var divCaches = {
    mennoBroCheckboxen:"",
    scanAssemblies:"",
    editAssembly:"",
    eventsConcerning:"",
    scanEvents:"",
    editEvent:"",
    assemblyState:"",
}

var midscreenStates =
    [["mennoBroCheckboxen","scanAssemblies"], //0
     ["mennoBroCheckboxen","editAssembly"],   //1
     ["eventsConcerning","scanEvents"],       //2
     ["editEvent"],                           //3
     ["assemblyState"],                       //4
    ]
                       
cacheDivs(); setMidscreen(0); 
    
document.getElementById("Brethren").checked = true; //must be AFTER setMidscreen 0 or 1
    
var bmhc = BMHCobj();
var denominations = 0;

setMidscreen(0);
setListboxInnerHTML();

function setMidscreen(k){
    var htmlStr = "";
    midscreenStates[k].forEach(item => htmlStr+=divCaches[item]);
    document.getElementById("midscreen").innerHTML = htmlStr;
}
    
function setListboxInnerHTML(){
    var names = [];
    if (denominations == 0) names = bmhc.getNeitherAssemblies();
    else if (denominations == 1) names = bmhc.getBrethrenAssemblies();
    else if (denominations == 2) names = bmhc.getMennoniteAssemblies();
    else names = bmhc.getAllAssemblies();
    document.getElementById("ss_elem_list").innerHTML = makeLIsOfArray(names);
}

function handleChangeBrethren(chkbox){
    if (chkbox.checked) denominations = denominations | 1;
    else denominations = denominations & 0xfffffe;  //...11110
    setListboxInnerHTML();
}
    
function handleChangeMennonite(chkbox){
    if (chkbox.checked) denominations = denominations | 2;
    else denominations = denominations & 0xfffffd;  //...11101
    setListboxInnerHTML();
}

function cacheDivs(){
    Object.keys(divCaches).forEach(key => {
        divCaches[key] = document.getElementById(key).innerHTML.slice();
    });
}

function readingAss() {
    document.getElementById("rwAss").innerHTML = "<div id=&quot;assemblyRead&quot;>"+rAss;+"</div>";
}

function writingAss(){
    document.getElementById("rwAss").innerHTML = "<div id=&quot;assemblyWrite&quot;>"+wAss;+"</div>";
}
    
/* unused
function makeLIsOfKeys(obj){
    var result = "";
    Object.keys(obj).forEach(function(key) {
        //console.log(key, obj[key]);
        result+= "<li id=\""+key+"\" role=\"option\">"+key+"</li>"; //"<li id=\"ss_elem_"+key+...
    });
    return result;
} unused */
    
function makeLIsOfArray(arr){
    var result = "";
    arr.forEach(makeli);
    return result;
    
    function makeli(val) {
      result+= "<li id=\""+val+"\" role=\"option\">"+val+"</li>";
    }
}

    
function checkGroup(str) {
  document.getElementById("copycat").innerHTML = str;
}
    
function saveGroup(str) {
    document.getElementById("copycat").innerHTML = "***"+document.getElementById("groupName").value+"***";
}
</script>

</body>
